<section id="projekte" class="py-20 bg-opacity-50 bg-brown-100">
  <header class="px-4 mx-auto">
    <h2 class="text-2xl font-extrabold md:text-3xl lg:text-4xl md:text-center">Wir stellen vor: Referenzprojekte</h2>
    <p class="mx-auto mt-2 text-lg text-gray-600 md:text-center max-w-prose">Regelmäßig betreuen wir einzigartige Projekte, auf die wir besonders stolz sind. Dabei handelt es sich manchmal um einen Großauftrag, der besonders viele unserer Leistungen in Anspruch nimmt, oder aber um ein Projekt, das die handwerkliche Begabung unserer Mitarbeiter besonders herausstellt. Wir aktualisieren diese Projekte regelmäßig.</p>
  </header>

  <div class="px-4 mx-auto mt-16 space-y-16 divide-y-2 md:divide-y-0 md:mt-20 md:space-y-24 max-w-default divide-brown-900">

    <!-- Container for projects -->
    
    {% for item in featured %}
      <article class="flex flex-wrap items-start pt-12 space-y-12 md:pt-0 md:flex-nowrap md:space-x-8 md:even:flex-row-reverse md:even:space-x-reverse md:space-y-0" x-data="{i:{{loop.index}} }" x-intersect.once="window.parent.gallery(i)">

        <div class="flex-auto space-y-10 md:flex-1 lg:space-y-12">

          <!-- Project Description -->
          <div>
            <h2 class="text-xl font-bold md:text-2xl">{{item.headline}}</h2>
            <p class="mt-2 text-sm text-gray-600 md:text-base">{{item.excerpt}}</p>
          </div>

          <!-- Features of the project -->
          <ul class="space-y-2">

            {% for item in item.features %}
              <li class="flex space-x-2 md:space-x-4 items-top">
                <div class="flex items-start flex-1 text-sm font-medium lg:text-base">
                  <span>›</span>
                  <p class="ml-1">{{item}}</p>
                </div>
              </li>
            {% endfor %}
          </ul>

          {% if item.customerName %}
          <div class="">
          <p class="font-semibold text-center">{{item.customerName}} | {{item.customerPosition}}</p>
          <p class="mt-4 italic">" {{item.customerReview}} "</p>
          </div>
          {% endif %}

        </div>

        <div class="flex-auto w-full md:flex-1">
          <div class="splide primary-slider-{{loop.index}}">
            <div class="splide__track">
              <ul class="splide__list">
                {% for item in item.images %}
                  <li class="splide__slide">
                    <div class="aspect-w-4 aspect-h-3">
                      <img class="object-cover w-full h-full overflow-hidden rounded-lg" src="{{item}}" alt="Ein Bild"/>
                    </div>
                  </li>
                  {%endfor%}
              </ul>
            </div>
          </div>
          <div class="mt-1 splide secondary-slider-{{loop.index}}">
            <div class="splide__track">
              <ul class="splide__list">
              {% for item in item.images %}
                <li class="splide__slide">
                <div class="aspect-w-4 aspect-h-3">
                  <img class="object-cover w-full h-full overflow-hidden rounded-md" src="{{item}}" alt="Ein Bild"/>
                  </div>
                </li>
                {%endfor%}           
              </ul>
            </div>
          </div>
        </div>

      </article>
    {% endfor %}

  </div>

</section>

<script type="module">
  
 var gallery = function(i) {
    var secondarySlider = new Splide('.secondary-slider-'+i, {
      fixedWidth: 96,
      gap: 10,
      cover: true,
      arrows: false,
      isNavigation: true,
      focus: 'center',
      breakpoints: {
        '600': {
          fixedWidth: 66
        }
      }
    }).mount();
    
    var primarySlider = new Splide('.primary-slider-'+i, {
      type: 'fade',
      width: '100%',
      pagination: false,
      arrows: false,
      cover: true
    }); // do not call mount() here.

    primarySlider
      .sync(secondarySlider)
      .mount();
  }

  window.gallery = gallery;
</script>